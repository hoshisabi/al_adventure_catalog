---
layout: default
title: Adventure Stats
---
<div class="container mx-auto px-4 py-8 max-w-screen-lg">
    <h1 class="text-3xl font-bold mb-6">Adventure Statistics</h1>
    <p class="mb-4"><a href="{{ site.baseurl }}/" class="text-blue-500 hover:underline">Return to Main Page</a></p>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
        <div>
            <h2 class="text-xl font-semibold mb-4">Adventures by Tier</h2>
            <canvas id="tier-chart"></canvas>
        </div>
        <div>
            <h2 class="text-xl font-semibold mb-4">Adventures by Duration</h2>
            <canvas id="duration-chart"></canvas>
        </div>
        <div>
            <h2 class="text-xl font-semibold mb-4">Adventures by Campaign</h2>
            <canvas id="campaign-chart"></canvas>
        </div>
        <div>
            <h2 class="text-xl font-semibold mb-4">Adventures by Season</h2>
            <canvas id="season-chart"></canvas>
        </div>
    </div>

    <div class="mt-8">
        <h2 class="text-2xl font-semibold mb-6">Seed Usage by Season</h2>
        <p class="mb-4 text-gray-600">Pie charts showing how popular each seed is for POA, WBW, and SJ campaigns.</p>
        <div id="seed-charts-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            <!-- Seed charts will be dynamically generated here -->
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
<script>
    fetch('assets/data/stats.json')
        .then(response => response.json())
        .then(data => {
            const tierCtx = document.getElementById('tier-chart').getContext('2d');
            new Chart(tierCtx, {
                type: 'bar',
                data: {
                    labels: Object.keys(data.tier),
                    datasets: [{
                        label: '# of Adventures',
                        data: Object.values(data.tier),
                        backgroundColor: 'rgba(54, 162, 235, 0.2)',
                        borderColor: 'rgba(54, 162, 235, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });

            const durationCtx = document.getElementById('duration-chart').getContext('2d');
            new Chart(durationCtx, {
                type: 'bar',
                data: {
                    labels: Object.keys(data.duration),
                    datasets: [{
                        label: '# of Adventures',
                        data: Object.values(data.duration),
                        backgroundColor: 'rgba(255, 99, 132, 0.2)',
                        borderColor: 'rgba(255, 99, 132, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });

            const campaignCtx = document.getElementById('campaign-chart').getContext('2d');
            new Chart(campaignCtx, {
                type: 'bar',
                data: {
                    labels: Object.keys(data.campaign),
                    datasets: [{
                        label: '# of Adventures',
                        data: Object.values(data.campaign),
                        backgroundColor: 'rgba(75, 192, 192, 0.2)',
                        borderColor: 'rgba(75, 192, 192, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
            
            const seasonCtx = document.getElementById('season-chart').getContext('2d');
            new Chart(seasonCtx, {
                type: 'bar',
                data: {
                    labels: Object.keys(data.season),
                    datasets: [{
                        label: '# of Adventures',
                        data: Object.values(data.season),
                        backgroundColor: 'rgba(153, 102, 255, 0.2)',
                        borderColor: 'rgba(153, 102, 255, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });

            // Generate seed charts
            if (data.seed_by_season && Object.keys(data.seed_by_season).length > 0) {
                const seedChartsContainer = document.getElementById('seed-charts-container');
                const colors = [
                    '#3498db', '#e74c3c', '#2ecc71', '#f39c12', '#9b59b6', 
                    '#1abc9c', '#e67e22', '#34495e', '#16a085', '#27ae60',
                    '#c0392b', '#8e44ad', '#2980b9', '#d35400', '#7f8c8d'
                ];

                Object.keys(data.seed_by_season).sort().forEach((seasonName, seasonIndex) => {
                    const seedCounts = data.seed_by_season[seasonName];
                    const seeds = Object.keys(seedCounts);
                    const counts = Object.values(seedCounts);
                    const total = counts.reduce((a, b) => a + b, 0);

                    if (total === 0) return;

                    // Create chart container
                    const chartDiv = document.createElement('div');
                    chartDiv.className = 'bg-white p-4 rounded-lg shadow';
                    
                    const chartTitle = document.createElement('h3');
                    chartTitle.className = 'text-lg font-semibold mb-2';
                    chartTitle.textContent = seasonName;
                    chartDiv.appendChild(chartTitle);

                    const chartInfo = document.createElement('p');
                    chartInfo.className = 'text-sm text-gray-600 mb-4';
                    chartInfo.textContent = `Total adventures with seeds: ${total}`;
                    chartDiv.appendChild(chartInfo);

                    const canvas = document.createElement('canvas');
                    canvas.id = `seed-chart-${seasonIndex}`;
                    chartDiv.appendChild(canvas);
                    seedChartsContainer.appendChild(chartDiv);

                    // Generate colors for this chart
                    const chartColors = seeds.map((_, i) => colors[i % colors.length]);

                    // Create pie chart
                    const ctx = canvas.getContext('2d');
                    new Chart(ctx, {
                        type: 'pie',
                        data: {
                            labels: seeds,
                            datasets: [{
                                data: counts,
                                backgroundColor: chartColors
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: true,
                            plugins: {
                                legend: {
                                    position: 'right',
                                    labels: {
                                        font: {
                                            size: 11
                                        },
                                        boxWidth: 12,
                                        padding: 8
                                    }
                                },
                                tooltip: {
                                    callbacks: {
                                        label: function(context) {
                                            const label = context.label || '';
                                            const value = context.parsed || 0;
                                            const percentage = total > 0 ? ((value / total) * 100).toFixed(1) : 0;
                                            return label + ': ' + value + ' (' + percentage + '%)';
                                        }
                                    }
                                }
                            }
                        }
                    });
                });
            }
        });
</script>
